{
  "version": 4,
  "terraform_version": "1.1.6",
  "serial": 27,
  "lineage": "93af8d5c-212a-735f-3563-2d0b7c22080c",
  "outputs": {
    "bastion_ip": {
      "value": "51.250.3.198",
      "type": "string"
    },
    "cluster_info": {
      "value": [
        {
          "assign_public_ip": false,
          "fqdn": "rc1a-u4f4wrmvgi1kp20f.mdb.yandexcloud.net",
          "name": "ingafen_db",
          "priority": 0,
          "replication_source": "",
          "replication_source_name": "",
          "role": "MASTER",
          "subnet_id": "e9bhudsbuhanqhm90261",
          "zone": "ru-central1-a"
        }
      ],
      "type": [
        "list",
        [
          "object",
          {
            "assign_public_ip": "bool",
            "fqdn": "string",
            "name": "string",
            "priority": "number",
            "replication_source": "string",
            "replication_source_name": "string",
            "role": "string",
            "subnet_id": "string",
            "zone": "string"
          }
        ]
      ]
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "bastion",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "fhmb0flv2tvjrejb3m43",
                "disk_id": "fhmb0flv2tvjrejb3m43",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8sc0f4358r8pt128gg",
                    "name": "",
                    "size": 10,
                    "snapshot_id": "",
                    "type": "network-ssd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2022-05-21T17:50:53Z",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "fqdn": "bastion.ru-central1.internal",
            "hostname": "bastion",
            "id": "fhmq450imb3nrn19h76g",
            "labels": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n",
              "user-data": "#!/bin/sh\napt update\napt install mc vim git python3-pip apt-transport-https ca-certificates curl -y\n\ngit clone https://github.com/kubernetes-sigs/kubespray.git\ncd kubespray\npip3 install -r requirements.txt\n\ndate \u003e\u003e log.txt\n\necho \"Create public key\" \u003e\u003e log.txt\ncat \u003c\u003cEOT \u003e id_rsa.pub\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n\nEOT\n\necho \"Create private key\" \u003e\u003e log.txt\ncat \u003c\u003cEOT \u003e id_rsa\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAQEAtUw0ZGghmHJjCcimmWoi7CA3zEZ6r9q36iIUTD8qaa4zwI+wuVgg\nUViCVwb25uDGf3QT5ZUBPdeZuQICgU9MMeAYqPzCFOi1prNB4JKOIiRWLL3KlcXkHBR9yn\nXFFkN5Gz+gd+m0wyKJjor8SVSqN89EyyS3c8m3hCqQF7ds60l4/06ovVoHG0oQiicvscvR\nSfjOSFP/rA5/08cl2RfJJYNlW/CsC1nK/eeF7gJzS/Ns1MnWHXFfe2nCW/IV+sF4RWleQ1\noeLklk7D7qveTs5Yyk16LSZplPWS4uWdBpjLvjYe7qB5v0rIL1FaeGp6RQdLdoKmAuTlLF\nlQBUVX+MhwAAA8i8TCKBvEwigQAAAAdzc2gtcnNhAAABAQC1TDRkaCGYcmMJyKaZaiLsID\nfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU\n6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKp\nAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL\n82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7u\noHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yHAAAAAwEAAQAAAQAfKxm6xVg5QDkcnn1d\n1KxqUeOl39wJzZ1eyDsbHKTrBELrcQid5LOxqHjIA2+BI9WcZdVh2+sZua4460qI9pwP2w\noCS2oGdDd+kETcGfYLkpmqGXrxotLjrPYvT23xtOnmMFsjIm+sOIzTj7tt0/trmtul3QsZ\nAe3l7/dTzHoSPQYybJdBgDVGS8+t4KEr7Q0WSA0J18e1myHs0JwA9TdxGoVCs2EyGMZ+wK\nYOrHvcY1jDskMdknh+7SNDWVqAzmYN8EKNKIiytHF5CdovO4Pbcm2B6DLkrtwa2bpP+pXc\nezRDr6x1YXZnIp8+UPzwb55Enk/dLlyTOkHWTD5oVouxAAAAgQCtBbbVX7DOLIDUwyWR7N\n/uqeSi9W2z85GVYeCg7a27NX/lt5Zl3VvwVW0v3hB97P2HjzV170R9ayYywW2qWS0wuT/w\nV3ECfQ6lJrpjRAj/XRaOhscFPz+qi7PkUaygPXMJPKP6IVysyJTQMNhkcLwAwhGX8+cWGy\npWw/3z1kqMmQAAAIEA5Wvo/1Pmu5+OPmui+Cud2CRjyaUZGwsUeM0efJYvqw2wYZOjOOss\nVBYEF452L5sxk0cgRU2La5LsfmC60pN5SvQFqEClwkTrGlqmAdPi2h0AX6bpY/H8FMHT9m\ngjoQetGJxjPHAPPao8leDg9jU+Q3ukD2CZc2BWncsQiUWRtj8AAACBAMpNDpnvylhPMriz\ng+XOVk2YEjo9SLe+4aKwtww+rPFBvuvC1bvkFKOzN6PrecHXcl4V1H2GinPu56/8p/Dxyv\nDZXm2zvxBhfgGN9FuQPk4noThkA0esTztTK3ou3ZHCldpQwovq+9lq/xY6HCBmHdOehLEp\nm/lx7lEVWLn8QOe5AAAAEHVidW50dUB5YW5kZXgucnUBAg==\n-----END OPENSSH PRIVATE KEY-----\n\nEOT\n\necho \"Change permissions and owners to ssh keys\" \u003e\u003e log.txt\nchmod 400 id_rsa\nchmod 400 id_rsa.pub\nchown ubuntu id_rsa\nchown ubuntu id_rsa.pub\n\necho \"Create Ansible config file\" \u003e\u003e log.txt\ncat \u003c\u003cEOT \u003e ansible.cfg\n[defaults]\nremote_user = ubuntu\nhost_key_checking = False\nprivate_key_file = id_rsa\n\n[privilege_escalation]\nbecome=True\nbecome_method=sudo\nbecome_user=root\nbecome_ask_pass=False\nEOT\n\necho \"Create Ansible inventory file\" \u003e\u003e log.txt\ncat \u003c\u003cEOT \u003e my-inventory.ini\n[k8s-cluster:children]\nkube-master\nkube-node\ncalico_rr\n\n[all]\nmaster ansible_host=192.168.21.30 ip=192.168.21.30\nsonarqubenode ansible_host=192.168.21.12 ip=192.168.21.12\nworker0 ansible_host=192.168.21.20 ip=192.168.21.20\nworker1 ansible_host=192.168.21.22 ip=192.168.21.22\n\n[kube-master]\nmaster\n\n[kube-node]\nsonarqubenode ansible_host=192.168.21.12 ip=192.168.21.12\nworker0 ansible_host=192.168.21.20 ip=192.168.21.20\nworker1 ansible_host=192.168.21.22 ip=192.168.21.22\n\n[etcd]\nmaster\n\n[calico-rr]\n\nEOT\n\nmkdir inventory/ingafen\ncp -r inventory/sample/group_vars/ inventory/ingafen/group_vars/\ncp my-inventory.ini inventory/ingafen/\nsed -i 's/helm_enabled: false/helm_enabled: true/' inventory/ingafen/group_vars/k8s_cluster/addons.yml\nansible-playbook -i inventory/ingafen/my-inventory.ini cluster.yml\n\ncat \u003c\u003cEOT \u003e sonar-values.yaml\ntolerations: \n  - key: \"sonarqube\"\n    operator: \"Equal\"\n    value: \"true\"\n    effect: \"NoSchedule\"\nnodeSelector: \n  sonarqube: \"true\"\npostgresql.persistence.enabled: \"false\"\nEOT\n\ncat \u003c\u003cEOT \u003e master.sh\nexport KUBECONFIG=/etc/kubernetes/admin.conf\nchown ubuntu:ubuntu /etc/kubernetes/admin.conf\n\nkubectl taint node sonarqubenode sonarqube=true:NoSchedule\nkubectl label node sonarqubenode sonarqube=true\nhelm repo add sonarqube https://SonarSource.github.io/helm-chart-sonarqube\nhelm repo update\nkubectl create namespace sonarqube\nhelm upgrade --install -n sonarqube -f sonar-values.yaml sonarqube sonarqube/sonarqube\n\nkubectl create namespace argocd\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\nkubectl patch svc argocd-server -n argocd -p '{\"spec\": {\"type\": \"NodePort\"}}'\n\ncurl -sSL -o /usr/local/bin/argocd https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64\nchmod +x /usr/local/bin/argocd\n\nEOT\n\nscp -i id_rsa -o StrictHostKeyChecking=no master.sh ubuntu@master:master.sh \nscp -i id_rsa -o StrictHostKeyChecking=no sonar-values.yaml ubuntu@master:sonar-values.yaml \nssh -i id_rsa -o StrictHostKeyChecking=no ubuntu@master \"sudo ./master.sh\"\n\ncat \u003c\u003cEOT \u003e cs-dev.txt\nHost=rc1a-y56jl19vq4dx3b42.mdb.yandexcloud.net;port=6432;sslmode=Require;Database=StarWarsKb;Username=ingafen;Password=Zn123456;Trust Server Certificate=true\nEOT\n\ncat \u003c\u003cEOT \u003e cs-prod.txt\nHost=rc1a-y56jl19vq4dx3b42.mdb.yandexcloud.net;port=6432;sslmode=Require;Database=StarWarsKb;Username=ingafen;Password=Zn123456;Trust Server Certificate=true\nEOT\n\n\n\n\ndate \u003e\u003e log.txt\n\necho \"Master ip is 192.168.21.30\"\n"
            },
            "name": "bastion",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "192.168.21.26",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:1a:21:41:2b",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.3.198",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e9bhudsbuhanqhm90261"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": ""
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "yandex_compute_instance.master",
            "yandex_compute_instance.sonarqubenode",
            "yandex_compute_instance.workers",
            "yandex_vpc_network.vpc",
            "yandex_vpc_subnet.public_subnet"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "master",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "fhm5acdg9da87v9eh75q",
                "disk_id": "fhm5acdg9da87v9eh75q",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8sc0f4358r8pt128gg",
                    "name": "",
                    "size": 20,
                    "snapshot_id": "",
                    "type": "network-ssd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2022-05-21T17:50:24Z",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "fqdn": "master.ru-central1.internal",
            "hostname": "master",
            "id": "fhmokcmh61dc7m9v3ubc",
            "labels": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n",
              "user-data": "apt-get update"
            },
            "name": "master",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "192.168.21.30",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:18:a3:2d:13",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.91.159",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e9bhudsbuhanqhm90261"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": ""
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "yandex_vpc_network.vpc",
            "yandex_vpc_subnet.public_subnet"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "sonarqubenode",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "fhmk03omrhh7fp1qttmv",
                "disk_id": "fhmk03omrhh7fp1qttmv",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8sc0f4358r8pt128gg",
                    "name": "",
                    "size": 20,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2022-05-21T17:50:24Z",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "fqdn": "sonarqubenode.ru-central1.internal",
            "hostname": "sonarqubenode",
            "id": "fhm7gni7ctlncepk1q5v",
            "labels": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n",
              "user-data": "apt-get update"
            },
            "name": "sonarqubenode",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "192.168.21.12",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:78:5e:47:67",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.86.141",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e9bhudsbuhanqhm90261"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": ""
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 6
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "yandex_vpc_network.vpc",
            "yandex_vpc_subnet.public_subnet"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "workers",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "fhmvegh7it2qcufrsm1b",
                "disk_id": "fhmvegh7it2qcufrsm1b",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8sc0f4358r8pt128gg",
                    "name": "",
                    "size": 20,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2022-05-21T17:50:24Z",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "fqdn": "worker0.ru-central1.internal",
            "hostname": "worker0",
            "id": "fhmd1sre3p53pr0h1rfr",
            "labels": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n",
              "user-data": "apt-get update"
            },
            "name": "worker0",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "192.168.21.20",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:d0:f3:6e:1e",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.89.168",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e9bhudsbuhanqhm90261"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": ""
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "yandex_vpc_network.vpc",
            "yandex_vpc_subnet.public_subnet"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "fhm7q2qb77q8sscm26b9",
                "disk_id": "fhm7q2qb77q8sscm26b9",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8sc0f4358r8pt128gg",
                    "name": "",
                    "size": 20,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2022-05-21T17:50:24Z",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "fqdn": "worker1.ru-central1.internal",
            "hostname": "worker1",
            "id": "fhmdic622o7hunvuebpc",
            "labels": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1TDRkaCGYcmMJyKaZaiLsIDfMRnqv2rfqIhRMPypprjPAj7C5WCBRWIJXBvbm4MZ/dBPllQE915m5AgKBT0wx4Bio/MIU6LWms0Hgko4iJFYsvcqVxeQcFH3KdcUWQ3kbP6B36bTDIomOivxJVKo3z0TLJLdzybeEKpAXt2zrSXj/Tqi9WgcbShCKJy+xy9FJ+M5IU/+sDn/TxyXZF8klg2Vb8KwLWcr954XuAnNL82zUydYdcV97acJb8hX6wXhFaV5DWh4uSWTsPuq95OzljKTXotJmmU9ZLi5Z0GmMu+Nh7uoHm/SsgvUVp4anpFB0t2gqYC5OUsWVAFRVf4yH ubuntu@yandex.ru\r\n",
              "user-data": "apt-get update"
            },
            "name": "worker1",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "192.168.21.22",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:d9:30:c2:16",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.85.9",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e9bhudsbuhanqhm90261"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": ""
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "yandex_vpc_network.vpc",
            "yandex_vpc_subnet.public_subnet"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_mdb_postgresql_cluster",
      "name": "db",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "config": [
              {
                "access": [
                  {
                    "data_lens": false,
                    "serverless": false,
                    "web_sql": false
                  }
                ],
                "autofailover": true,
                "backup_retain_period_days": 7,
                "backup_window_start": [
                  {
                    "hours": 0,
                    "minutes": 0
                  }
                ],
                "performance_diagnostics": [
                  {
                    "enabled": false,
                    "sessions_sampling_interval": 60,
                    "statements_sampling_interval": 600
                  }
                ],
                "pooler_config": [],
                "postgresql_config": {},
                "resources": [
                  {
                    "disk_size": 10,
                    "disk_type_id": "network-ssd",
                    "resource_preset_id": "b2.nano"
                  }
                ],
                "version": "14"
              }
            ],
            "created_at": "2022-05-21T17:50:23Z",
            "database": [
              {
                "extension": [],
                "lc_collate": "C",
                "lc_type": "C",
                "name": "swkb-dev-db",
                "owner": "ingafen"
              },
              {
                "extension": [],
                "lc_collate": "C",
                "lc_type": "C",
                "name": "swkb-test-db",
                "owner": "ingafen"
              },
              {
                "extension": [],
                "lc_collate": "C",
                "lc_type": "C",
                "name": "swkb-prod-db",
                "owner": "ingafen"
              }
            ],
            "deletion_protection": false,
            "description": "",
            "environment": "PRODUCTION",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "health": "HEALTH_UNKNOWN",
            "host": [
              {
                "assign_public_ip": false,
                "fqdn": "rc1a-u4f4wrmvgi1kp20f.mdb.yandexcloud.net",
                "name": "ingafen_db",
                "priority": 0,
                "replication_source": "",
                "replication_source_name": "",
                "role": "MASTER",
                "subnet_id": "e9bhudsbuhanqhm90261",
                "zone": "ru-central1-a"
              }
            ],
            "host_master_name": "ingafen_db",
            "id": "c9ql2c27eq3tk71ac3f6",
            "labels": {},
            "maintenance_window": [
              {
                "day": "",
                "hour": 0,
                "type": "ANYTIME"
              }
            ],
            "name": "db",
            "network_id": "enp2un2lib0maprc5glq",
            "restore": [],
            "security_group_ids": [],
            "status": "RUNNING",
            "timeouts": null,
            "user": [
              {
                "conn_limit": 50,
                "grants": [],
                "login": true,
                "name": "ingafen",
                "password": "your_pass",
                "permission": [
                  {
                    "database_name": "swkb-dev-db"
                  },
                  {
                    "database_name": "swkb-prod-db"
                  },
                  {
                    "database_name": "swkb-test-db"
                  }
                ],
                "settings": {}
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjkwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "yandex_vpc_network.vpc"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_vpc_network",
      "name": "vpc",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": "2022-05-21T17:50:22Z",
            "default_security_group_id": "",
            "description": "",
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "id": "enp2un2lib0maprc5glq",
            "labels": {},
            "name": "Ingafen vpc",
            "subnet_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMCwiZGVsZXRlIjo2MDAwMDAwMDAwMCwidXBkYXRlIjo2MDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_vpc_subnet",
      "name": "public_subnet",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": "2022-05-21T17:50:23Z",
            "description": "",
            "dhcp_options": [],
            "folder_id": "b1ge84ugruo7njkf9ku9",
            "id": "e9bhudsbuhanqhm90261",
            "labels": {},
            "name": "public_subnet",
            "network_id": "enp2un2lib0maprc5glq",
            "route_table_id": "",
            "timeouts": null,
            "v4_cidr_blocks": [
              "192.168.21.0/24"
            ],
            "v6_cidr_blocks": [],
            "zone": "ru-central1-a"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAsImRlbGV0ZSI6MTgwMDAwMDAwMDAwLCJ1cGRhdGUiOjE4MDAwMDAwMDAwMH19",
          "dependencies": [
            "yandex_vpc_network.vpc"
          ]
        }
      ]
    }
  ]
}
